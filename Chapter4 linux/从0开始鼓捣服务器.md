# ä»0å¼€å§‹é¼“æ£æœåŠ¡å™¨

[toc]

## 1.åˆ›å»ºç”¨æˆ·

ç”¨rootç”¨æˆ·æ“ä½œæƒé™å¤ªå¤§ï¼Œå› æ­¤åˆ›å»ºä¸€ä¸ªdeployç”¨æˆ·ç”¨äºæ—¥å¸¸çš„ä½¿ç”¨ã€‚

```shell
# åˆ›å»ºdeployç”¨æˆ·å¹¶è®¾ç½®å¯†ç 
useradd deploy
passwd deploy
# è®¾ç½®deployç”¨æˆ·rootå…å¯†
visudo
#æ·»åŠ ä»¥ä¸‹å†…å®¹åˆ° root ALL=(ALL) ALL åé¢
deploy ALL=(ALL) NOPASSWD:ALL
```

## 2.å®‰è£…docker

### 2.1 å®‰è£…å¿…è¦è½¯ä»¶åŒ…

```shell
sudo yum install -y yum-utils   device-mapper-persistent-data   lvm2
```

### 2.2 æ·»åŠ è½¯ä»¶æº

```shell
sudo yum-config-manager --add-repo http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo
```

### 2.3 æŸ¥çœ‹dockerç‰ˆæœ¬

```shell
sudo yum list docker-ce --showduplicates | sort -r
```

### 2.4 å®‰è£…docker

```shell
sudo yum install docker-ce-3:19.03.8-3.el7
```

oopsï¼Œå®‰è£…çš„æ—¶å€™æŠ¥é”™äº†

```shell
Last metadata expiration check: 0:01:36 ago on Mon 23 Mar 2020 10:11:44 AM CST.
Error: 
 Problem: package docker-ce-3:19.03.8-3.el7.x86_64 requires containerd.io >= 1.2.2-3, but none of the providers can be installed
  - conflicting requests
  - package containerd.io-1.2.10-3.2.el7.x86_64 is excluded
  - package containerd.io-1.2.13-3.1.el7.x86_64 is excluded
  - package containerd.io-1.2.2-3.3.el7.x86_64 is excluded
  - package containerd.io-1.2.2-3.el7.x86_64 is excluded
  - package containerd.io-1.2.4-3.1.el7.x86_64 is excluded
  - package containerd.io-1.2.5-3.1.el7.x86_64 is excluded
  - package containerd.io-1.2.6-3.3.el7.x86_64 is excluded
(try to add '--skip-broken' to skip uninstallable packages or '--nobest' to use not only best candidate packages)
```

çœ‹äº†ä¸‹èƒ½å®‰è£…çš„containerd.ioçš„ç‰ˆæœ¬ï¼Œå­¦ä¼šæ”¾å¼ƒï¼Œè£…ä¸äº†ç‰ˆæœ¬é‚£ä¹ˆé«˜çš„ã€‚

```shell
sudo yum list containerd.io --showduplicates | sort -r
Last metadata expiration check: 0:08:42 ago on Mon 23 Mar 2020 10:11:44 AM CST.
Installed Packages
containerd.io.x86_64           1.2.0-3.el7                     docker-ce-stable 
containerd.io.x86_64           1.2.0-3.el7                     @docker-ce-stable
containerd.io.x86_64           1.2.0-2.2.rc.2.1.el7            docker-ce-stable 
containerd.io.x86_64           1.2.0-2.0.rc.0.1.el7            docker-ce-stable 
containerd.io.x86_64           1.2.0-1.2.beta.2.el7            docker-ce-stable 
Available Packages
```

å†æ¬¡å°è¯•å®‰è£…ä½ç‰ˆæœ¬çš„docker

```shell
sudo yum install -y docker-ce-18.06.3.ce-3.el7
```

### 2.5 å¯åŠ¨dockerå¹¶åŠ å…¥å¼€æœºè‡ªå¯å¤§ç¤¼åŒ…

```
sudo systemctl start docker
sudo systemctl enable docker
```

### 2.6 éªŒè¯å®‰è£…

```shell
sudo docker version
Client:
 Version:           18.06.3-ce
 API version:       1.38
 Go version:        go1.10.3
 Git commit:        d7080c1
 Built:             Wed Feb 20 02:26:51 2019
 OS/Arch:           linux/amd64
 Experimental:      false

Server:
 Engine:
  Version:          18.06.3-ce
  API version:      1.38 (minimum version 1.12)
  Go version:       go1.10.3
  Git commit:       d7080c1
  Built:            Wed Feb 20 02:28:17 2019
  OS/Arch:          linux/amd64
  Experimental:     false
```



## 3.å®‰è£…java

ç”±äºæˆ‘ä¸ªäººç”¨çš„æ¯”è¾ƒå¤šçš„æ˜¯jdk8ï¼Œæ‰€ä»¥æˆ‘è¿˜æ˜¯å®‰è£…è¿™ä¸ªç‰ˆæœ¬çš„

```shell
sudo yum install -y java-1.8.0-openjdk.x86_64
```

è£…å®Œä¹‹åå‘ç°jpséƒ½ç”¨ä¸äº†ï¼Œä¸€ç•ªæœç´¢å¾—çŸ¥è¦ä¸‹è½½develç‰ˆæœ¬çš„

```shell
sudo yum install -y java-1.8.0-openjdk-devel.x86_64
```

é‡è£…ä¸€ä¸ªå°±å¥½äº†

## 4.å®‰è£…python

### 4.1 ä¸‹è½½python å®‰è£…åŒ…å¹¶è§£å‹

ç”±äºæˆ‘pythonç”¨å¾—å°‘ï¼Œæ‰€ä»¥ä¸ä»‹æ„å½“å°ç™½é¼ ä½“éªŒä¸€ä¸‹æœ€æ–°ç‰ˆğŸ˜

```shell
wget https://www.python.org/ftp/python/3.9.0/Python-3.9.0a4.tar.xz
tar -xvJf  Python-3.9.0a4.tar.xz
```

### 4.2 å®‰è£…

```shell
mkdir /usr/local/python3 
cd Python-3.9.0a4
./configure --prefix=/usr/local/python3 --enable-optimizations --with-ssl 
#ç¬¬ä¸€ä¸ªæŒ‡å®šå®‰è£…çš„è·¯å¾„,ä¸æŒ‡å®šçš„è¯,å®‰è£…è¿‡ç¨‹ä¸­å¯èƒ½è½¯ä»¶æ‰€éœ€è¦çš„æ–‡ä»¶å¤åˆ¶åˆ°å…¶ä»–ä¸åŒç›®å½•,åˆ é™¤è½¯ä»¶å¾ˆä¸æ–¹ä¾¿,å¤åˆ¶è½¯ä»¶ä¹Ÿä¸æ–¹ä¾¿.
#ç¬¬äºŒä¸ªå¯ä»¥æé«˜python10%-20%ä»£ç è¿è¡Œé€Ÿåº¦.
#ç¬¬ä¸‰ä¸ªæ˜¯ä¸ºäº†å®‰è£…pipéœ€è¦ç”¨åˆ°ssl,åé¢æŠ¥é”™ä¼šæœ‰æåˆ°.
make && make install
```

### 4.3 åˆ›å»ºè½¯é“¾

```shell
ln -s /usr/local/python3/bin/python3 /usr/local/bin/python3
ln -s /usr/local/python3/bin/pip3 /usr/local/bin/pip3
```

### 4.4 éªŒè¯

```shell
python3 -V
pip3 -V
```

## 5.å®‰è£…git

```shell
yum install git -y
```

## 6.å®‰è£…nginxå¹¶é…ç½®é™æ€é¡µé¢

```shell
yum install nginx -y
```

ä¿®æ”¹nginxé…ç½®æ–‡ä»¶ï¼Œä¿®æ”¹é€å‡ºçš„ç«¯å£

![image-20200526185903504](https://markdown-image-upload.oss-cn-beijing.aliyuncs.com/img/image-20200526185903504.png)

ç„¶åä½¿ç”¨`nginx`å‘½ä»¤å¯åŠ¨(å¦‚æœé‡å¯ä½¿ç”¨`nginx -s reload`)

![image-20200526190014640](https://markdown-image-upload.oss-cn-beijing.aliyuncs.com/img/image-20200526190014640.png)

æ­¤æ—¶è®¿é—®9000ç«¯å£ï¼Œå¯ä»¥çœ‹åˆ°nginxé¡µé¢äº†ã€‚

æ­¤æ—¶å¯ä»¥éƒ¨ç½²é™æ€é¡µé¢äº†ã€‚

æ­£å¥½æˆ‘æœ‰ä¸ªgitbookç”Ÿæˆçš„é™æ€é¡µé¢æ–‡ä»¶ï¼Œä¸Šä¼ åˆ°æœåŠ¡å™¨ä¸Šã€‚

ä¿®æ”¹nginxé…ç½®æŠŠrootçš„åœ°å€ä»/usr/share/nginx/html æ”¹æˆ /data/_book

é‡å¯nginxæœåŠ¡å™¨ã€‚

æˆäº†ã€‚

## å®‰è£…npmå’Œnode.js

```
yum install nodejs -y
```

æ›´æ¢é•œåƒæº

```
npm config set registry http://registry.npm.taobao.org
```

## å®‰è£…gitBook

å®‰è£…gitbook-cliè„šæ‰‹æ¶

```
npm install -g gitbook-cli
```

æ£€æŸ¥æ˜¯å¦å®‰è£…å®Œæˆ

```shell
gitbook -V
# æ­¤æ—¶å¯èƒ½ä¼šå¡åœ¨ä¸‹é¢çŠ¶æ€æ¯”è¾ƒä¹…ï¼Œé‚£æ˜¯åœ¨å®‰è£…GitBook,ç­‰ç€å°±å¥½äº†
CLI version: 2.3.2
Installing GitBook 3.2.3
```

## è®¾ç½®å®šæ—¶è„šæœ¬

```shell
crontab -l 
# æŸ¥çœ‹crontabå®šæ—¶ä»»åŠ¡
crontab -e
# ç¼–è¾‘å®šæ—¶ä»»åŠ¡
```

åœ¨å®šæ—¶ä»»åŠ¡ä¸­åŠ å…¥

```shell
0 10-20/1 * * * cd /data && sh update-gitbook.sh
# 10ç‚¹åˆ°20ç‚¹ï¼Œæ¯å°æ—¶æ‰§è¡Œæ›´æ–°è„šæœ¬
```

æ›´æ–°è„šæœ¬å¦‚ä¸‹

```shell
cd /data/starry-sky-of-a-simple-programmer;
git pull;
gitbook build;
```

